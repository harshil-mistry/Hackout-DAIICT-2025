{% extends "base.html" %}

{% block title %}Enhanced Dashboard - CoastalGuard AI{% endblock %}

{% block content %}
<!-- Dashboard Header -->
<div class="bg-white border-b border-gray-200">
    <div class="max-w-full mx-auto px-4 py-6">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Enhanced Dashboard</h1>
                <p class="text-gray-600 mt-1">Advanced coastal threat monitoring for Gujarat with detailed analytics</p>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Overall Status Indicator -->
                <div class="flex items-center bg-green-50 px-4 py-2 rounded-lg">
                    <div class="w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                    <span class="text-green-800 font-medium">All Systems Active</span>
                </div>
                <!-- Sidebar Toggle -->
                <button id="sidebar-toggle" class="bg-ocean-blue text-white px-4 py-2 rounded-lg hover:bg-ocean-dark transition-colors">
                    <i class="fas fa-bars mr-2"></i>City Details
                </button>
                <!-- Last Updated -->
                <div class="text-sm text-gray-500">
                    <i class="fas fa-clock mr-1"></i>
                    Last updated: <span id="last-updated">2 minutes ago</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Debug Information -->
<div class="max-w-full mx-auto px-4 py-2">
    <div class="bg-gray-100 border border-gray-300 rounded-lg p-3 mb-4">
        <div class="flex items-center justify-between text-sm">
            <div class="flex items-center space-x-4">
                <span class="font-medium text-gray-700">ðŸ”§ Debug Info:</span>
                
                <!-- Weather Data Status -->
                <div class="flex items-center">
                    {% if weather_data %}
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                        <span class="text-green-700 font-medium">Real-time Weather Data</span>
                    {% else %}
                        <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                        <span class="text-red-700 font-medium">Static Weather Data</span>
                    {% endif %}
                </div>
                
                <!-- API Status -->
                <div class="flex items-center">
                    {% if summary_stats %}
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                        <span class="text-green-700 font-medium">Dynamic Stats</span>
                    {% else %}
                        <div class="w-2 h-2 bg-orange-500 rounded-full mr-2"></div>
                        <span class="text-orange-700 font-medium">Fallback Stats</span>
                    {% endif %}
                </div>
                
                <!-- Data Source -->
                <div class="flex items-center">
                    {% if error %}
                        <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                        <span class="text-red-700 font-medium">API Error Mode</span>
                    {% else %}
                        <div class="w-2 h-2 bg-blue-500 rounded-full mr-2"></div>
                        <span class="text-blue-700 font-medium">
                            {% if weather_data %}Live API{% else %}Mock Data{% endif %}
                        </span>
                    {% endif %}
                </div>
            </div>
            
            <!-- Data Count -->
            <div class="text-gray-600">
                Cities: {{ all_cities_data|length if all_cities_data else 0 }} | 
                Weather: {{ weather_data|length if weather_data else 0 }} | 
                Alerts: {{ ai_alerts|length if ai_alerts else 0 }}
            </div>
        </div>
        
        <!-- Additional Debug Details -->
        {% if weather_data %}
            <div class="mt-2 text-xs text-gray-600">
                <strong>Active Cities:</strong> 
                {% for city in weather_data.keys() %}
                    {{ city }}{% if not loop.last %}, {% endif %}
                {% endfor %}
            </div>
        {% endif %}
    </div>
</div>

<!-- Main Dashboard Layout with Sidebar -->
<div class="flex max-w-full mx-auto">
    <!-- City Details Sidebar -->
    <div id="city-sidebar" class="w-80 bg-white shadow-lg border-r border-gray-200 min-h-screen transition-all duration-300">
        <div class="p-6 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">
                <i class="fas fa-map-marker-alt text-ocean-blue mr-2"></i>
                Gujarat Cities
            </h2>
            
            <!-- City List -->
            <div class="space-y-2">
                {% if all_cities_data %}
                    {% for city, data in all_cities_data.items() %}
                        <div class="city-item cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition-all" 
                             data-city="{{ city }}">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas {{ data.icon }} text-ocean-blue mr-3"></i>
                                    <div>
                                        <h4 class="font-medium text-gray-900">{{ city }}</h4>
                                        <p class="text-sm text-gray-600">{{ data.temperature }}Â°C â€¢ {{ data.description }}</p>
                                    </div>
                                </div>
                                <div class="flex items-center">
                                    {% set threat_color = 'text-green-600' if data.threat_level == 'green' else 'text-yellow-600' if data.threat_level == 'yellow' else 'text-red-600' %}
                                    <div class="w-3 h-3 
                                        {% if data.threat_level == 'green' %}bg-green-500{% elif data.threat_level == 'yellow' %}bg-yellow-500{% else %}bg-red-500{% endif %} 
                                        rounded-full"></div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <!-- Fallback city list -->
                    <div class="space-y-2">
                        <div class="city-item cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-blue-50" data-city="Ahmedabad">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-anchor text-ocean-blue mr-3"></i>
                                    <div>
                                        <h4 class="font-medium">Ahmedabad</h4>
                                        <p class="text-sm text-gray-600">28Â°C â€¢ Clear Sky</p>
                                    </div>
                                </div>
                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                            </div>
                        </div>
                        <div class="city-item cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-blue-50" data-city="Surat">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-ship text-ocean-blue mr-3"></i>
                                    <div>
                                        <h4 class="font-medium">Surat</h4>
                                        <p class="text-sm text-gray-600">26Â°C â€¢ Partly Cloudy</p>
                                    </div>
                                </div>
                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                            </div>
                        </div>
                        <div class="city-item cursor-pointer p-3 rounded-lg border border-gray-200 hover:bg-blue-50" data-city="Dwarka">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-water text-ocean-blue mr-3"></i>
                                    <div>
                                        <h4 class="font-medium">Dwarka</h4>
                                        <p class="text-sm text-gray-600">25Â°C â€¢ Windy</p>
                                    </div>
                                </div>
                                <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Detailed City Info Panel -->
        <div id="city-details" class="p-6">
            <div class="text-center text-gray-500">
                <i class="fas fa-mouse-pointer text-3xl mb-3"></i>
                <p>Click on a city above to view detailed weather information</p>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="flex-1 px-4 py-8">
        {% if error %}
            <!-- Error Message -->
            <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-8">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-circle text-red-400"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-red-700">
                            Error loading dashboard data: {{ error }}. Using fallback data.
                        </p>
                    </div>
                </div>
            </div>
        {% endif %}
        
        <!-- Enhanced Alert Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <!-- Total Alerts -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-2 bg-blue-100 rounded-lg">
                        <i class="fas fa-bell text-blue-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Total Alerts</p>
                        <p class="text-2xl font-bold text-gray-900">{{ summary_stats.total_alerts if summary_stats else 24 }}</p>
                        <p class="text-xs text-gray-500">Last 24 hours</p>
                    </div>
                </div>
            </div>
            
            <!-- Critical Alerts -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-2 bg-red-100 rounded-lg">
                        <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Critical</p>
                        <p class="text-2xl font-bold text-red-600">{{ summary_stats.critical_alerts if summary_stats else 0 }}</p>
                        <p class="text-xs text-gray-500">Requires action</p>
                    </div>
                </div>
            </div>
            
            <!-- Monitored Cities -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-2 bg-green-100 rounded-lg">
                        <i class="fas fa-map-marker-alt text-green-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Cities</p>
                        <p class="text-2xl font-bold text-gray-900">{{ summary_stats.monitored_cities if summary_stats else 10 }}</p>
                        <p class="text-xs text-gray-500">Active monitoring</p>
                    </div>
                </div>
            </div>
            
            <!-- Community Reports -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-2 bg-purple-100 rounded-lg">
                        <i class="fas fa-users text-purple-600 text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Reports</p>
                        <p class="text-2xl font-bold text-gray-900">{{ summary_stats.community_reports if summary_stats else 7 }}</p>
                        <p class="text-xs text-gray-500">Community input</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Weather Overview Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Current Weather Highlights -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">
                        <i class="fas fa-cloud-sun text-blue-500 mr-2"></i>
                        Weather Highlights
                    </h2>
                    <div class="text-sm text-gray-500">Real-time data</div>
                </div>
                
                <!-- Weather Cards Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% if weather_data %}
                        {% for city, data in weather_data.items() %}
                            <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="font-semibold text-gray-900">{{ city }}</h3>
                                    <i class="fas {{ data.icon }} text-blue-600 text-xl"></i>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-3 text-sm">
                                    <div>
                                        <p class="text-gray-600">Temperature</p>
                                        <p class="font-bold text-lg">{{ data.temperature }}Â°C</p>
                                        <p class="text-xs text-gray-500">Feels like {{ data.feels_like }}Â°C</p>
                                    </div>
                                    <div>
                                        <p class="text-gray-600">Humidity</p>
                                        <p class="font-bold text-lg">{{ data.humidity }}%</p>
                                        <p class="text-xs text-gray-500">{{ data.description|title }}</p>
                                    </div>
                                    
                                    {% if data.wind_speed %}
                                    <div>
                                        <p class="text-gray-600">Wind</p>
                                        <p class="font-bold">{{ data.wind_speed }} km/h</p>
                                        <p class="text-xs text-gray-500">{{ data.wind_direction }}</p>
                                    </div>
                                    {% endif %}
                                    
                                    {% if data.sea_conditions %}
                                    <div>
                                        <p class="text-gray-600">Sea Conditions</p>
                                        <p class="font-bold">{{ data.sea_conditions }}</p>
                                        <p class="text-xs text-gray-500">{{ data.wave_height }}m waves</p>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <!-- Additional Weather Metrics -->
                                {% if data.pressure or data.uv_index %}
                                <div class="mt-3 pt-3 border-t border-blue-200">
                                    <div class="flex justify-between text-xs">
                                        {% if data.pressure %}
                                        <span class="text-gray-600">Pressure: <strong>{{ data.pressure }} hPa</strong></span>
                                        {% endif %}
                                        {% if data.uv_index %}
                                        <span class="text-gray-600">UV Index: <strong>{{ data.uv_index }}</strong></span>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                    {% else %}
                        <!-- Fallback weather cards -->
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="font-semibold text-gray-900">Ahmedabad</h3>
                                <i class="fas fa-sun text-yellow-500 text-xl"></i>
                            </div>
                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <p class="text-gray-600">Temperature</p>
                                    <p class="font-bold text-lg">28Â°C</p>
                                    <p class="text-xs text-gray-500">Feels like 31Â°C</p>
                                </div>
                                <div>
                                    <p class="text-gray-600">Humidity</p>
                                    <p class="font-bold text-lg">65%</p>
                                    <p class="text-xs text-gray-500">Clear Sky</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200">
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="font-semibold text-gray-900">Surat</h3>
                                <i class="fas fa-cloud text-gray-500 text-xl"></i>
                            </div>
                            <div class="grid grid-cols-2 gap-3 text-sm">
                                <div>
                                    <p class="text-gray-600">Temperature</p>
                                    <p class="font-bold text-lg">26Â°C</p>
                                    <p class="text-xs text-gray-500">Feels like 29Â°C</p>
                                </div>
                                <div>
                                    <p class="text-gray-600">Humidity</p>
                                    <p class="font-bold text-lg">72%</p>
                                    <p class="text-xs text-gray-500">Partly Cloudy</p>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- AI Alert Analysis -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">
                        <i class="fas fa-brain text-purple-500 mr-2"></i>
                        AI Alert Analysis
                    </h2>
                    <div class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                        Powered by Gemini AI
                    </div>
                </div>
                
                <!-- Alert Cards -->
                <div class="space-y-4">
                    {% if ai_alerts %}
                        {% for alert in ai_alerts %}
                            <div class="border border-gray-200 rounded-lg p-4 
                                {% if alert.priority == 'high' %}bg-red-50 border-red-200{% elif alert.priority == 'medium' %}bg-yellow-50 border-yellow-200{% else %}bg-blue-50 border-blue-200{% endif %}">
                                <div class="flex items-start justify-between">
                                    <div class="flex items-start">
                                        <div class="p-2 rounded-lg mr-3
                                            {% if alert.priority == 'high' %}bg-red-100{% elif alert.priority == 'medium' %}bg-yellow-100{% else %}bg-blue-100{% endif %}">
                                            <i class="fas {{ alert.icon }} 
                                                {% if alert.priority == 'high' %}text-red-600{% elif alert.priority == 'medium' %}text-yellow-600{% else %}text-blue-600{% endif %}"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">{{ alert.title }}</h4>
                                            <p class="text-sm text-gray-700 mt-1">{{ alert.description }}</p>
                                            <div class="flex items-center mt-2 text-xs text-gray-500">
                                                <i class="fas fa-map-marker-alt mr-1"></i>
                                                <span>{{ alert.location }}</span>
                                                <span class="mx-2">â€¢</span>
                                                <i class="fas fa-clock mr-1"></i>
                                                <span>{{ alert.time }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="inline-block px-2 py-1 rounded-full text-xs font-medium
                                            {% if alert.priority == 'high' %}bg-red-100 text-red-800{% elif alert.priority == 'medium' %}bg-yellow-100 text-yellow-800{% else %}bg-blue-100 text-blue-800{% endif %}">
                                            {{ alert.priority|upper }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <!-- Fallback alerts -->
                        <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                            <div class="flex items-start">
                                <div class="p-2 bg-green-100 rounded-lg mr-3">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">All Clear</h4>
                                    <p class="text-sm text-gray-700 mt-1">No immediate threats detected. All coastal monitoring systems are functioning normally.</p>
                                    <div class="flex items-center mt-2 text-xs text-gray-500">
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        <span>Gujarat Coast</span>
                                        <span class="mx-2">â€¢</span>
                                        <i class="fas fa-clock mr-1"></i>
                                        <span>5 minutes ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Community Reports and Marine Data -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Community Reports -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">
                        <i class="fas fa-users text-green-500 mr-2"></i>
                        Community Reports
                    </h2>
                    <a href="{{ url_for('community') }}" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                        View All â†’
                    </a>
                </div>
                
                <!-- Report Items -->
                <div class="space-y-4">
                    {% if community_reports %}
                        {% for report in community_reports %}
                            <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50">
                                <div class="flex items-start justify-between">
                                    <div class="flex items-start">
                                        <div class="p-2 bg-blue-100 rounded-lg mr-3">
                                            <i class="fas {{ report.icon }} text-blue-600"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-gray-900">{{ report.title }}</h4>
                                            <p class="text-sm text-gray-700 mt-1">{{ report.description }}</p>
                                            <div class="flex items-center mt-2 text-xs text-gray-500">
                                                <i class="fas fa-user mr-1"></i>
                                                <span>{{ report.reporter }}</span>
                                                <span class="mx-2">â€¢</span>
                                                <i class="fas fa-map-marker-alt mr-1"></i>
                                                <span>{{ report.location }}</span>
                                                <span class="mx-2">â€¢</span>
                                                <span>{{ report.time }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="inline-block px-2 py-1 rounded-full text-xs font-medium
                                            {% if report.status == 'verified' %}bg-green-100 text-green-800{% elif report.status == 'pending' %}bg-yellow-100 text-yellow-800{% else %}bg-gray-100 text-gray-800{% endif %}">
                                            {{ report.status|upper }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        <!-- Fallback community reports -->
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <div class="p-2 bg-blue-100 rounded-lg mr-3">
                                    <i class="fas fa-waves text-blue-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">High Tide Warning</h4>
                                    <p class="text-sm text-gray-700 mt-1">Unusually high tide observed near Dwarka beach area. Visitors advised to maintain safe distance.</p>
                                    <div class="flex items-center mt-2 text-xs text-gray-500">
                                        <i class="fas fa-user mr-1"></i>
                                        <span>Local Fisherman</span>
                                        <span class="mx-2">â€¢</span>
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        <span>Dwarka</span>
                                        <span class="mx-2">â€¢</span>
                                        <span>1 hour ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <div class="p-2 bg-green-100 rounded-lg mr-3">
                                    <i class="fas fa-check-circle text-green-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-900">Safe Swimming Conditions</h4>
                                    <p class="text-sm text-gray-700 mt-1">Clear water and calm conditions reported at Mandvi beach. Perfect for recreational activities.</p>
                                    <div class="flex items-center mt-2 text-xs text-gray-500">
                                        <i class="fas fa-user mr-1"></i>
                                        <span>Beach Guard</span>
                                        <span class="mx-2">â€¢</span>
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        <span>Mandvi</span>
                                        <span class="mx-2">â€¢</span>
                                        <span>30 minutes ago</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Marine Conditions -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-gray-900">
                        <i class="fas fa-anchor text-blue-500 mr-2"></i>
                        Marine Conditions
                    </h2>
                    <div class="text-sm text-gray-500">Arabian Sea</div>
                </div>
                
                <!-- Marine Data Grid -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-blue-50 rounded-lg p-4 text-center">
                        <i class="fas fa-water text-blue-600 text-2xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">Wave Height</h4>
                        <p class="text-2xl font-bold text-blue-600">1.2m</p>
                        <p class="text-xs text-gray-600">Moderate waves</p>
                    </div>
                    
                    <div class="bg-green-50 rounded-lg p-4 text-center">
                        <i class="fas fa-thermometer-half text-green-600 text-2xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">Sea Temp</h4>
                        <p class="text-2xl font-bold text-green-600">24Â°C</p>
                        <p class="text-xs text-gray-600">Optimal</p>
                    </div>
                    
                    <div class="bg-yellow-50 rounded-lg p-4 text-center">
                        <i class="fas fa-eye text-yellow-600 text-2xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">Visibility</h4>
                        <p class="text-2xl font-bold text-yellow-600">8km</p>
                        <p class="text-xs text-gray-600">Good</p>
                    </div>
                    
                    <div class="bg-purple-50 rounded-lg p-4 text-center">
                        <i class="fas fa-compress-arrows-alt text-purple-600 text-2xl mb-2"></i>
                        <h4 class="font-semibold text-gray-900">Tide Level</h4>
                        <p class="text-2xl font-bold text-purple-600">High</p>
                        <p class="text-xs text-gray-600">Rising</p>
                    </div>
                </div>
                
                <!-- Additional Marine Info -->
                <div class="border-t border-gray-200 pt-4">
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p class="text-gray-600">Sunrise</p>
                            <p class="font-semibold">6:42 AM</p>
                        </div>
                        <div>
                            <p class="text-gray-600">Sunset</p>
                            <p class="font-semibold">6:15 PM</p>
                        </div>
                        <div>
                            <p class="text-gray-600">Moon Phase</p>
                            <p class="font-semibold">ðŸŒ“ First Quarter</p>
                        </div>
                        <div>
                            <p class="text-gray-600">Fishing</p>
                            <p class="font-semibold text-green-600">Favorable</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Sidebar and Interactive Features -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Sidebar toggle functionality
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const citySidebar = document.getElementById('city-sidebar');
    const cityItems = document.querySelectorAll('.city-item');
    const cityDetails = document.getElementById('city-details');
    
    if (sidebarToggle && citySidebar) {
        sidebarToggle.addEventListener('click', function() {
            citySidebar.classList.toggle('hidden');
            
            // Update button text
            const isHidden = citySidebar.classList.contains('hidden');
            sidebarToggle.innerHTML = isHidden ? 
                '<i class="fas fa-bars mr-2"></i>Show Cities' : 
                '<i class="fas fa-times mr-2"></i>Hide Cities';
        });
    }
    
    // City item click handlers
    cityItems.forEach(item => {
        item.addEventListener('click', function() {
            const cityName = this.dataset.city;
            
            // Remove active class from all items
            cityItems.forEach(i => i.classList.remove('bg-blue-100', 'border-blue-300'));
            
            // Add active class to clicked item
            this.classList.add('bg-blue-100', 'border-blue-300');
            
            // Load detailed city information
            loadCityDetails(cityName);
        });
    });
    
    // Function to load city details
    function loadCityDetails(cityName) {
        // Show loading state
        cityDetails.innerHTML = `
            <div class="text-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-ocean-blue mx-auto mb-3"></div>
                <p class="text-gray-600">Loading ${cityName} details...</p>
            </div>
        `;
        
        // Simulate API call (replace with actual API call)
        setTimeout(() => {
            const detailsHTML = generateCityDetailsHTML(cityName);
            cityDetails.innerHTML = detailsHTML;
        }, 1000);
    }
    
    // Function to generate city details HTML
    function generateCityDetailsHTML(cityName) {
        // This would typically come from an API call
        const mockData = {
            temperature: Math.floor(Math.random() * 15) + 20,
            humidity: Math.floor(Math.random() * 40) + 50,
            windSpeed: Math.floor(Math.random() * 20) + 5,
            pressure: Math.floor(Math.random() * 50) + 1000,
            visibility: Math.floor(Math.random() * 5) + 5,
            uvIndex: Math.floor(Math.random() * 10) + 1,
            airQuality: ['Good', 'Moderate', 'Unhealthy'][Math.floor(Math.random() * 3)]
        };
        
        return `
            <div class="space-y-4">
                <div class="border-b border-gray-200 pb-4">
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">
                        <i class="fas fa-map-marker-alt text-ocean-blue mr-2"></i>
                        ${cityName} Details
                    </h3>
                    <p class="text-sm text-gray-600">Detailed weather and marine conditions</p>
                </div>
                
                <div class="grid grid-cols-1 gap-3">
                    <div class="bg-blue-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Temperature</span>
                            <span class="text-lg font-bold text-blue-600">${mockData.temperature}Â°C</span>
                        </div>
                        <div class="w-full bg-blue-200 rounded-full h-2 mt-2">
                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${(mockData.temperature / 40) * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Humidity</span>
                            <span class="text-lg font-bold text-green-600">${mockData.humidity}%</span>
                        </div>
                        <div class="w-full bg-green-200 rounded-full h-2 mt-2">
                            <div class="bg-green-600 h-2 rounded-full" style="width: ${mockData.humidity}%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Wind Speed</span>
                            <span class="text-lg font-bold text-yellow-600">${mockData.windSpeed} km/h</span>
                        </div>
                        <div class="w-full bg-yellow-200 rounded-full h-2 mt-2">
                            <div class="bg-yellow-600 h-2 rounded-full" style="width: ${(mockData.windSpeed / 25) * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="bg-purple-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Pressure</span>
                            <span class="text-lg font-bold text-purple-600">${mockData.pressure} hPa</span>
                        </div>
                    </div>
                    
                    <div class="bg-indigo-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Visibility</span>
                            <span class="text-lg font-bold text-indigo-600">${mockData.visibility} km</span>
                        </div>
                    </div>
                    
                    <div class="bg-orange-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">UV Index</span>
                            <span class="text-lg font-bold text-orange-600">${mockData.uvIndex}</span>
                        </div>
                    </div>
                    
                    <div class="bg-teal-50 rounded-lg p-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium text-gray-700">Air Quality</span>
                            <span class="text-lg font-bold text-teal-600">${mockData.airQuality}</span>
                        </div>
                    </div>
                </div>
                
                <div class="border-t border-gray-200 pt-4 mt-4">
                    <h4 class="font-medium text-gray-900 mb-3">48-Hour Forecast</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center text-sm">
                            <span class="text-gray-600">Tomorrow</span>
                            <div class="flex items-center">
                                <i class="fas fa-sun text-yellow-500 mr-2"></i>
                                <span class="font-medium">${mockData.temperature + 2}Â°C / ${mockData.temperature - 3}Â°C</span>
                            </div>
                        </div>
                        <div class="flex justify-between items-center text-sm">
                            <span class="text-gray-600">Day After</span>
                            <div class="flex items-center">
                                <i class="fas fa-cloud text-gray-500 mr-2"></i>
                                <span class="font-medium">${mockData.temperature + 1}Â°C / ${mockData.temperature - 2}Â°C</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-100 rounded-lg p-3 mt-4">
                    <div class="flex items-center">
                        <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                        <span class="text-sm text-blue-800 font-medium">Marine Safety</span>
                    </div>
                    <p class="text-xs text-blue-700 mt-1">Conditions are favorable for coastal activities. Monitor updates for any changes.</p>
                </div>
            </div>
        `;
    }
    
    // Auto-refresh functionality
    function updateTimestamp() {
        const timestamp = document.getElementById('last-updated');
        if (timestamp) {
            const now = new Date();
            const minutes = Math.floor(Math.random() * 5) + 1;
            timestamp.textContent = `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
        }
    }
    
    // Update timestamp every 30 seconds
    setInterval(updateTimestamp, 30000);
    
    // Initial timestamp update
    updateTimestamp();
});
</script>
{% endblock %}
